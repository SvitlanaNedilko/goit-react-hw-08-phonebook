(this["webpackJsonpgoit-react-hw-08-phonebook"]=this["webpackJsonpgoit-react-hw-08-phonebook"]||[]).push([[0],{14:function(t,e,n){"use strict";var c=n(16),a=n.n(c),r=n(22),o=n(18),s=n.n(o),u=n(3);s.a.defaults.baseURL="https://connections-api.herokuapp.com";var i=function(t){s.a.defaults.headers.common.Authorization="Bearer ".concat(t)},l=function(){s.a.defaults.headers.common.Authorization=""},b={register:Object(u.c)("auth/register",function(){var t=Object(r.a)(a.a.mark((function t(e){var n,c;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,s.a.post("/users/signup",e);case 3:return n=t.sent,c=n.data,i(c.token),t.abrupt("return",c);case 9:t.prev=9,t.t0=t.catch(0);case 11:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()),logIn:Object(u.c)("auth/login",function(){var t=Object(r.a)(a.a.mark((function t(e){var n,c;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,s.a.post("/users/login",e);case 3:return n=t.sent,c=n.data,i(c.token),t.abrupt("return",c);case 9:t.prev=9,t.t0=t.catch(0);case 11:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()),logOut:Object(u.c)("auth/logout",Object(r.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,s.a.post("/users/logout");case 3:l(),t.next=8;break;case 6:t.prev=6,t.t0=t.catch(0);case 8:case"end":return t.stop()}}),t,null,[[0,6]])})))),fetchCurrentUser:Object(u.c)("auth/refresh",function(){var t=Object(r.a)(a.a.mark((function t(e,n){var c,r,o;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c=n.getState(),null!==(r=c.auth.token)){t.next=4;break}return t.abrupt("return",n.rejectWithValue());case 4:return i(r),t.prev=5,t.next=8,s.a.get("/users/current");case 8:return o=t.sent,t.abrupt("return",o.data);case 12:t.prev=12,t.t0=t.catch(5);case 14:case"end":return t.stop()}}),t,null,[[5,12]])})));return function(e,n){return t.apply(this,arguments)}}())};e.a=b},74:function(t,e,n){},75:function(t,e,n){},78:function(t,e,n){},79:function(t,e,n){},82:function(t,e,n){"use strict";n.r(e);var c=n(0),a=n.n(c),r=n(25),o=n.n(r),s=n(7),u=n(43),i=n(4),l=n(14),b={getIsLoggenIn:function(t){return t.auth.isLoggenIn},getUsername:function(t){return t.auth.user.name},getIsFetchingCurrent:function(t){return t.auth.isFetchingCurrentUser}},j=n(15),d=(n(74),n(75),n(1));function O(){var t=Object(s.c)(b.getUsername),e=Object(s.b)();return Object(d.jsxs)("div",{className:"user_menu",children:[Object(d.jsx)("span",{children:"Hello ".concat(t)}),Object(d.jsx)("button",{className:"button-logout",type:"button",onClick:function(){e(l.a.logOut())},children:"logout"})]})}function h(){var t=Object(s.c)(b.getIsLoggenIn);return Object(d.jsxs)("div",{className:"navigation",children:[Object(d.jsxs)("nav",{children:[Object(d.jsx)(j.b,{to:"/",exact:!0,className:"link",activeClassName:"activlink",children:"Home"}),!t&&Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(j.b,{to:"/register",exact:!0,className:"link",activeClassName:"activlink",children:"Registration"}),Object(d.jsx)(j.b,{to:"/login",className:"link",activeClassName:"activlink",children:"LogIn"})]}),t&&Object(d.jsx)(j.b,{to:"/contactsbook",className:"link",activeClassName:"activlink",children:"contactsbook"})]}),t&&Object(d.jsx)(O,{})]})}var f=n(20),g=n(28),p=["children","redirectTo"];function v(t){var e=t.children,n=t.redirectTo,c=void 0===n?"/":n,a=Object(g.a)(t,p),r=Object(s.c)(b.getIsLoggenIn);return Object(d.jsx)(i.b,Object(f.a)(Object(f.a)({},a),{},{children:r?e:Object(d.jsx)(i.a,{to:c})}))}var x=["children","redirectTo","restricted"];function C(t){var e=t.children,n=t.redirectTo,c=void 0===n?"/":n,a=t.restricted,r=void 0!==a&&a,o=Object(g.a)(t,x),u=Object(s.c)(b.getIsLoggenIn)&&r;return Object(d.jsx)(i.b,Object(f.a)(Object(f.a)({},o),{},{children:u?Object(d.jsx)(i.a,{to:c}):e}))}n(78);var k=Object(c.lazy)((function(){return n.e(5).then(n.bind(null,97))})),m=Object(c.lazy)((function(){return n.e(4).then(n.bind(null,98))})),I=Object(c.lazy)((function(){return n.e(3).then(n.bind(null,100))})),y=Object(c.lazy)((function(){return n.e(6).then(n.bind(null,99))}));var S,w,R,N=function(){var t=Object(s.b)(),e=Object(s.c)(b.getIsFetchingCurrent);return Object(c.useEffect)((function(){t(l.a.fetchCurrentUser())}),[t]),!e&&Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("div",{className:"AppRoot",children:Object(d.jsx)(h,{})}),Object(d.jsx)("div",{className:"AppRoot",children:Object(d.jsx)(i.d,{children:Object(d.jsxs)(c.Suspense,{fallback:Object(d.jsx)("p",{children:"\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c...."}),children:[Object(d.jsx)(C,{exact:!0,path:"/",children:Object(d.jsx)(y,{})}),Object(d.jsx)(C,{path:"/register",restricted:!0,redirectTo:"/contactsbook",children:Object(d.jsx)(k,{})}),Object(d.jsx)(C,{path:"/login",restricted:!0,redirectTo:"/contactsbook",children:Object(d.jsx)(m,{})}),Object(d.jsx)(v,{path:"/contactsbook",redirectTo:"/",children:Object(d.jsx)(I,{})})]})})})]})},U=(n(79),n(27)),F=n(3),L=n(45),q=n.n(L),D=n(17),E=n(46),T=n.n(E),z=n(5),A=n(6),H=n(9),J=Object(F.d)([],(S={},Object(z.a)(S,H.a.fatchContactSuccess,(function(t,e){return e.payload})),Object(z.a)(S,H.a.addContactSuccess,(function(t,e){var n=e.payload;return[].concat(Object(U.a)(t),[n])})),Object(z.a)(S,H.a.onDeleteContactSuccess,(function(t,e){var n=e.payload;return t.filter((function(t){return t.id!==n}))})),S)),B=Object(F.d)(!1,(w={},Object(z.a)(w,H.a.fatchContactRequest,(function(){return!0})),Object(z.a)(w,H.a.fatchContactSuccess,(function(){return!1})),Object(z.a)(w,H.a.fatchContactError,(function(){return!1})),Object(z.a)(w,H.a.addContactRequest,(function(){return!0})),Object(z.a)(w,H.a.addContactSuccess,(function(){return!1})),Object(z.a)(w,H.a.addContactError,(function(){return!1})),Object(z.a)(w,H.a.onDeleteContactRequest,(function(){return!0})),Object(z.a)(w,H.a.onDeleteContactSuccess,(function(){return!1})),Object(z.a)(w,H.a.onDeleteContactError,(function(){return!1})),w)),M=Object(F.d)("",Object(z.a)({},H.a.changeFilter,(function(t,e){return e.payload}))),V=Object(A.b)({contactItems:J,filter:M,loading:B}),W=Object(F.e)({name:"auth",initialState:{user:{name:null,email:null},token:null,isLoggenIn:!1,isFetchingCurrentUser:!1},extraReducers:(R={},Object(z.a)(R,l.a.register.fulfilled,(function(t,e){t.user=e.payload.user,t.token=e.payload.token,t.isLoggenIn=!0})),Object(z.a)(R,l.a.logIn.fulfilled,(function(t,e){t.user=e.payload.user,t.token=e.payload.token,t.isLoggenIn=!0})),Object(z.a)(R,l.a.logOut.fulfilled,(function(t,e){t.user={name:null,email:null},t.token=null,t.isLoggenIn=!1})),Object(z.a)(R,l.a.fetchCurrentUser.pending,(function(t){t.isFetchingCurrentUser=!0})),Object(z.a)(R,l.a.fetchCurrentUser.fulfilled,(function(t,e){t.user=e.payload,t.isLoggenIn=!0,t.isFetchingCurrentUser=!1})),Object(z.a)(R,l.a.fetchCurrentUser.rejected,(function(t){t.isFetchingCurrentUser=!1})),R)}).reducer,_=[].concat(Object(U.a)(Object(F.f)({serializableCheck:{ignoredActions:[D.a,D.f,D.b,D.c,D.d,D.e]}})),[q.a]),G={key:"auth",storage:T.a,whitelist:["token"]},K=Object(F.a)({reducer:{contacts:V,auth:Object(D.g)(G,W)},middleware:_,devTools:!1}),P=Object(D.h)(K);o.a.render(Object(d.jsx)(a.a.StrictMode,{children:Object(d.jsx)(s.a,{store:K,children:Object(d.jsx)(u.a,{loading:null,persistor:P,children:Object(d.jsx)(j.a,{children:Object(d.jsx)(N,{})})})})}),document.querySelector("#root"))},9:function(t,e,n){"use strict";var c=n(3),a=Object(c.b)("contacts/fatchContactRequest"),r=Object(c.b)("contacts/fatchContactSuccess"),o=Object(c.b)("contacts/fatchContactError"),s=Object(c.b)("contacts/addContactRequest"),u=Object(c.b)("contacts/addContactSuccess"),i=Object(c.b)("contacts/addContactError"),l=Object(c.b)("contacts/onDeleteContactRequest"),b=Object(c.b)("contacts/onDeleteContactSuccess"),j={fatchContactRequest:a,fatchContactSuccess:r,fatchContactError:o,addContactRequest:s,addContactSuccess:u,addContactError:i,onDeleteContactError:Object(c.b)("contacts/onDeleteContactError"),onDeleteContactRequest:l,onDeleteContactSuccess:b,changeFilter:Object(c.b)("contacts/changeFilter")};e.a=j}},[[82,1,2]]]);
//# sourceMappingURL=main.1cdc7ab3.chunk.js.map